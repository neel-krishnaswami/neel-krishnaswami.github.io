<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN">
<!-- Created by htmlize-1.36 in css mode. -->
<html>
  <head>
    <title>test2.adjs</title>
    <style type="text/css">
    <!--
      body {
        color: #ffffff;
        background-color: #2f4f4f;
      }
      .caml-types-def {
        /* caml-types-def-face */
        background-color: #FF4444;
      }
      .caml-types-expr {
        /* caml-types-expr-face */
        background-color: #88FF44;
      }
      .caml-types-occ {
        /* caml-types-occ-face */
        background-color: #44FF44;
      }
      .caml-types-scope {
        /* caml-types-scope-face */
        background-color: #BBFFFF;
      }
      .caml-types-typed {
        /* caml-types-typed-face */
        background-color: #FF8844;
      }
      .function-name {
        /* font-lock-function-name-face */
        color: #87cefa;
      }
      .keyword {
        /* font-lock-keyword-face */
        color: #00ffff;
      }
      .ocaml-help {
        /* ocaml-help-face */
        background-color: #88FF44;
      }
      .string {
        /* font-lock-string-face */
        color: #ffa07a;
      }
      .tuareg-font-lock-governing {
        /* tuareg-font-lock-governing-face */
        color: #ffa500;
        font-weight: bold;
      }
      .tuareg-font-lock-operator {
        /* tuareg-font-lock-operator-face */
        color: #f0e68c;
      }
      .type {
        /* font-lock-type-face */
        color: #98fb98;
      }
      .variable-name {
        /* font-lock-variable-name-face */
        color: #eedd82;
      }

      a {
        color: inherit;
        background-color: inherit;
        font: inherit;
        text-decoration: inherit;
      }
      a:hover {
        text-decoration: underline;
      }
    -->
    </style>
  </head>
  <body>
    <pre>
 1<span class="tuareg-font-lock-operator">:</span> <span class="tuareg-font-lock-governing">val</span><span class="type"> </span><span class="variable-name">map </span><span class="tuareg-font-lock-operator">:</span> &#8704; a b. &#9633;<span class="tuareg-font-lock-operator">(</span>a &#8594; b<span class="tuareg-font-lock-operator">)</span> &#8594; stream a &#8594; stream b
 2<span class="tuareg-font-lock-operator">:</span> <span class="tuareg-font-lock-governing">let</span><span class="type"> </span><span class="tuareg-font-lock-governing">rec</span><span class="type"> </span><span class="variable-name">map </span>&#9633;f <span class="tuareg-font-lock-operator">(</span>x <span class="tuareg-font-lock-operator">::</span> xs<span class="tuareg-font-lock-operator">)</span> <span class="tuareg-font-lock-operator">=</span> f x <span class="tuareg-font-lock-operator">::</span> map <span class="tuareg-font-lock-operator">(</span>&#9633;f<span class="tuareg-font-lock-operator">)</span> xs
 3<span class="tuareg-font-lock-operator">:</span> 
 <span class="type">4</span><span class="tuareg-font-lock-operator">:</span> <span class="tuareg-font-lock-governing">val</span> <span class="variable-name">unfold </span><span class="tuareg-font-lock-operator">:</span> &#8704; a b. &#9633;<span class="tuareg-font-lock-operator">(</span>a &#8594; b &#215; &#8226;a<span class="tuareg-font-lock-operator">)</span> &#8594; a &#8594; stream b
 5<span class="tuareg-font-lock-operator">:</span> <span class="tuareg-font-lock-governing">let</span><span class="type"> </span><span class="tuareg-font-lock-governing">rec</span><span class="type"> </span><span class="variable-name">unfold </span>&#9633;f seed <span class="tuareg-font-lock-operator">=</span>
 6<span class="tuareg-font-lock-operator">:</span>   <span class="tuareg-font-lock-governing">let</span><span class="variable-name"> </span><span class="tuareg-font-lock-operator">(</span>v<span class="tuareg-font-lock-operator">,</span> &#8226;seed<span class="tuareg-font-lock-operator">)</span> <span class="tuareg-font-lock-operator">=</span> f seed <span class="tuareg-font-lock-governing">in</span>
 7<span class="tuareg-font-lock-operator">:</span>   <span class="type">v </span><span class="tuareg-font-lock-operator">::</span> unfold <span class="tuareg-font-lock-operator">(</span>&#9633;f<span class="tuareg-font-lock-operator">)</span> seed
 8<span class="tuareg-font-lock-operator">:</span> 
 <span class="type">9</span><span class="tuareg-font-lock-operator">:</span> <span class="tuareg-font-lock-governing">val</span> <span class="variable-name">count </span><span class="tuareg-font-lock-operator">:</span> <span class="type">stream bool </span>&#8594; stream num
10<span class="tuareg-font-lock-operator">:</span> <span class="tuareg-font-lock-governing">let</span><span class="type"> </span><span class="function-name">count</span><span class="variable-name"> bs </span><span class="tuareg-font-lock-operator">=</span>
11<span class="tuareg-font-lock-operator">:</span>   <span class="type">unfold</span>
12<span class="tuareg-font-lock-operator">:</span>     <span class="tuareg-font-lock-operator">(</span>&#9633;<span class="tuareg-font-lock-operator">(</span><span class="keyword">fun</span> <span class="tuareg-font-lock-operator">(</span><span class="variable-name">n</span><span class="tuareg-font-lock-operator">,</span><span class="variable-name"> </span><span class="tuareg-font-lock-operator">(</span><span class="variable-name">b </span><span class="tuareg-font-lock-operator">::</span> bs<span class="tuareg-font-lock-operator">))</span> &#8594;
13<span class="tuareg-font-lock-operator">:</span>          <span class="tuareg-font-lock-governing">let</span><span class="type"> </span><span class="variable-name">m </span><span class="tuareg-font-lock-operator">:</span> num <span class="tuareg-font-lock-operator">=</span> <span class="keyword">if</span> b <span class="keyword">then</span> n<span class="tuareg-font-lock-operator">+</span>1 <span class="keyword">else</span> n <span class="tuareg-font-lock-governing">in</span> 
14<span class="tuareg-font-lock-operator">:</span>          <span class="tuareg-font-lock-operator">(</span>m<span class="tuareg-font-lock-operator">,</span> &#8226;<span class="tuareg-font-lock-operator">(</span>m<span class="tuareg-font-lock-operator">,</span> bs<span class="tuareg-font-lock-operator">))))</span>
15<span class="tuareg-font-lock-operator">:</span>     <span class="tuareg-font-lock-operator">(</span><span class="type">0</span><span class="tuareg-font-lock-operator">,</span><span class="type"> bs</span><span class="tuareg-font-lock-operator">)</span>
16<span class="tuareg-font-lock-operator">:</span> 
<span class="type">17</span><span class="tuareg-font-lock-operator">:</span> <span class="tuareg-font-lock-governing">val</span> <span class="variable-name">dynlabel </span><span class="tuareg-font-lock-operator">:</span> <span class="type">stream string </span>&#8594; G<span class="tuareg-font-lock-operator">(</span>&#8707;a. dom a<span class="tuareg-font-lock-operator">)</span>
18<span class="tuareg-font-lock-operator">:</span> <span class="tuareg-font-lock-governing">let</span><span class="type"> </span><span class="function-name">dynlabel</span><span class="variable-name"> msgs </span><span class="tuareg-font-lock-operator">=</span>
19<span class="tuareg-font-lock-operator">:</span>   <span class="type">G</span><span class="tuareg-font-lock-operator">(</span><span class="tuareg-font-lock-governing">val</span> <span class="variable-name">update </span><span class="tuareg-font-lock-operator">:</span> &#8704; a. F<span class="tuareg-font-lock-operator">(</span>stream string<span class="tuareg-font-lock-operator">)</span> &#8888; dom a &#8888; dom a 
20<span class="tuareg-font-lock-operator">:</span>     <span class="tuareg-font-lock-governing">let</span><span class="type"> </span><span class="tuareg-font-lock-governing">rec</span><span class="type"> </span><span class="function-name">update</span><span class="variable-name"> </span><span class="tuareg-font-lock-operator">(</span>F<span class="tuareg-font-lock-operator">(</span>s <span class="tuareg-font-lock-operator">::</span> ss<span class="tuareg-font-lock-operator">))</span> w <span class="tuareg-font-lock-operator">=</span>
21<span class="tuareg-font-lock-operator">:</span>       <span class="tuareg-font-lock-governing">let</span><span class="type"> </span><span class="variable-name">w </span><span class="tuareg-font-lock-operator">=</span> run <span class="tuareg-font-lock-operator">(</span>text s<span class="tuareg-font-lock-operator">)</span> w <span class="tuareg-font-lock-governing">in</span> 
22<span class="tuareg-font-lock-operator">:</span>       <span class="tuareg-font-lock-governing">let</span><span class="variable-name"> </span><span class="tuareg-font-lock-operator">(</span>w0 <span class="tuareg-font-lock-operator">::</span> w1<span class="tuareg-font-lock-operator">)</span> <span class="tuareg-font-lock-operator">=</span> w <span class="tuareg-font-lock-governing">in</span>
23<span class="tuareg-font-lock-operator">:</span>       <span class="type">w0 </span><span class="tuareg-font-lock-operator">::</span> update <span class="tuareg-font-lock-operator">(</span>F ss<span class="tuareg-font-lock-operator">)</span> w1
24<span class="tuareg-font-lock-operator">:</span>     <span class="tuareg-font-lock-governing">in</span>
25<span class="tuareg-font-lock-operator">:</span>     <span class="tuareg-font-lock-governing">let</span><span class="type"> </span><span class="variable-name">w </span><span class="tuareg-font-lock-operator">=</span> run <span class="tuareg-font-lock-operator">(</span>mkText <span class="string">""</span><span class="tuareg-font-lock-operator">)</span> <span class="tuareg-font-lock-governing">in</span> 
26<span class="tuareg-font-lock-operator">:</span>     <span class="type">update </span><span class="tuareg-font-lock-operator">(</span><span class="type">F msgs</span><span class="tuareg-font-lock-operator">)</span><span class="type"> w</span><span class="tuareg-font-lock-operator">)</span>
27<span class="tuareg-font-lock-operator">:</span> 
<span class="type">28</span><span class="tuareg-font-lock-operator">:</span> <span class="tuareg-font-lock-governing">val</span> <span class="variable-name">main </span><span class="tuareg-font-lock-operator">:</span> <span class="type">G</span><span class="tuareg-font-lock-operator">(</span>&#8707;a. dom a<span class="tuareg-font-lock-operator">)</span>
29<span class="tuareg-font-lock-operator">:</span> <span class="tuareg-font-lock-governing">let</span><span class="type"> </span><span class="variable-name">main </span><span class="tuareg-font-lock-operator">=</span>
30<span class="tuareg-font-lock-operator">:</span>   <span class="type">G</span><span class="tuareg-font-lock-operator">(</span><span class="tuareg-font-lock-governing">let</span> <span class="variable-name">w </span><span class="tuareg-font-lock-operator">=</span> run mkButton <span class="tuareg-font-lock-governing">in</span>
31<span class="tuareg-font-lock-operator">:</span>     <span class="tuareg-font-lock-governing">let</span><span class="variable-name"> </span><span class="tuareg-font-lock-operator">(</span><span class="variable-name">w</span><span class="tuareg-font-lock-operator">,</span><span class="variable-name"> F bs</span><span class="tuareg-font-lock-operator">)</span><span class="variable-name"> </span><span class="tuareg-font-lock-operator">=</span> run clicks w <span class="tuareg-font-lock-governing">in</span>
32<span class="tuareg-font-lock-operator">:</span>     <span class="tuareg-font-lock-governing">let</span><span class="type"> </span><span class="variable-name">w0 </span><span class="tuareg-font-lock-operator">=</span> run <span class="tuareg-font-lock-operator">(</span>dynlabel <span class="tuareg-font-lock-operator">(</span>map <span class="tuareg-font-lock-operator">(</span>&#9633;toString<span class="tuareg-font-lock-operator">)</span> <span class="tuareg-font-lock-operator">(</span>count bs<span class="tuareg-font-lock-operator">)))</span> <span class="tuareg-font-lock-governing">in</span>
33<span class="tuareg-font-lock-operator">:</span>     <span class="type">run attach </span><span class="tuareg-font-lock-operator">(</span><span class="type">w</span><span class="tuareg-font-lock-operator">,</span><span class="type"> w0</span><span class="tuareg-font-lock-operator">))</span>  
34<span class="tuareg-font-lock-operator">:</span> 
<span class="type">35</span><span class="tuareg-font-lock-operator">:</span> <span class="tuareg-font-lock-governing">in</span> main 
</pre>
  </body>
</html>
